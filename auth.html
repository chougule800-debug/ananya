<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neuro Specialities - Access</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .auth-card {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        .logo { font-size: 40px; margin-bottom: 10px; }
        h2 { color: #1e3a8a; margin-bottom: 20px; }
        input {
            width: 100%; padding: 12px; margin: 8px 0;
            border: 1px solid #e5e7eb; border-radius: 6px; box-sizing: border-box;
        }
        .btn {
            width: 100%; padding: 12px; background: #1e3a8a; color: white;
            border: none; border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 15px;
        }
        .btn:hover { background: #1e40af; }
        .toggle-link {
            display: block; margin-top: 15px; color: #6b7280; font-size: 14px; cursor: pointer;
        }
        .toggle-link:hover { color: #1e3a8a; text-decoration: underline; }
        .error-msg { color: #ef4444; font-size: 13px; margin-top: 10px; display: none; }
        
        /* Toggle Visibility */
        .hidden { display: none; }
    </style>
</head>
<body>

    <div class="auth-card">
        <div class="logo">üè•</div>
        <h2 id="formTitle">Doctor Login</h2>
        
        <div id="loginForm">
            <input type="email" id="loginEmail" placeholder="Email Address">
            <input type="password" id="loginPass" placeholder="Password">
            <button class="btn" onclick="login()">Login</button>
            <span class="toggle-link" onclick="toggleForms()">New Staff? Register with Code</span>
        </div>

        <div id="signupForm" class="hidden">
            <input type="email" id="regEmail" placeholder="Email Address">
            <input type="password" id="regPass" placeholder="Password (Min 6 chars)">
            <input type="password" id="regPassConfirm" placeholder="Re-enter Password">
            <input type="text" id="regCode" placeholder="Unique Clinic Code" style="border-color: #f59e0b;">
            <button class="btn" style="background:#059669;" onclick="signup()">Register Staff</button>
            <span class="toggle-link" onclick="toggleForms()">Back to Login</span>
        </div>

        <div id="errorMsg" class="error-msg"></div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

        // --- YOUR FIREBASE CONFIG ---
        const firebaseConfig = {
          apiKey: "AIzaSyAWNn0lX3UzfKkZ2ivirPMb3vu9GNGLcfg",
          authDomain: "doc-det.firebaseapp.com",
          projectId: "doc-det",
          storageBucket: "doc-det.firebasestorage.app",
          messagingSenderId: "618914142158",
          appId: "1:618914142158:web:0ee8c35b219cf92533fd9f",
          measurementId: "G-CR3H21D0MC"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // --- SECURITY CODE ---
        const SECRET_CODE = "NEURO2026"; // <--- CHANGE THIS CODE if needed

        // Check if already logged in
        onAuthStateChanged(auth, (user) => {
            if (user) window.location.href = "index.html";
        });

        window.login = async () => {
            const email = document.getElementById('loginEmail').value;
            const pass = document.getElementById('loginPass').value;
            showError("");

            try {
                await signInWithEmailAndPassword(auth, email, pass);
                // Redirect happens in onAuthStateChanged
            } catch (error) {
                showError("Invalid Email or Password");
            }
        };

        window.signup = async () => {
            const email = document.getElementById('regEmail').value;
            const pass = document.getElementById('regPass').value;
            const confirm = document.getElementById('regPassConfirm').value;
            const code = document.getElementById('regCode').value;

            if(code !== SECRET_CODE) return showError("Invalid Clinic Code! Ask Dr. Wali.");
            if(pass !== confirm) return showError("Passwords do not match.");
            if(pass.length < 6) return showError("Password must be 6+ chars.");

            try {
                await createUserWithEmailAndPassword(auth, email, pass);
                alert("Account Created! Logging in...");
                // Redirect happens automatically
            } catch (error) {
                showError(error.message);
            }
        };

        window.toggleForms = () => {
            document.getElementById('loginForm').classList.toggle('hidden');
            document.getElementById('signupForm').classList.toggle('hidden');
            const isLogin = !document.getElementById('loginForm').classList.contains('hidden');
            document.getElementById('formTitle').innerText = isLogin ? "Doctor Login" : "Staff Registration";
            showError("");
        };

        function showError(msg) {
            const el = document.getElementById('errorMsg');
            el.innerText = msg;
            el.style.display = msg ? 'block' : 'none';
        }
    </script>
</body>
</html>